<div class="pre-footer clearfix">
    <div class="float-left">
        Inspired by signwriting, <br>
        designed for screens.
    </div>
    <div class="float-right">
        <a class="pre-footer__next">Origins & Process â†’</a>
    </div>
</div>
<div class="footer bg-dark">
    <h4>Coming soon to Google Fonts!</h4>
    <p>Recursive is under active development and will soon be available through Google Fonts. 
Want (very occassional) updates on new releases of Recursive? Sign up!</p>
</div>

<!-- JS -->

<!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script> -->
<!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script> -->
<!-- <script src="/js/aos.js"></script>
<script>
    AOS.init();
</script> -->
<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
<script type="text/javascript" src="/js/script.js"></script>

<script>
    var element = document.getElementById('mdSection');
    var textNode = element.firstChild;
    var URI = textNode.data;

    var simplemde = new SimpleMDE({
	autofocus: true,
	autosave: {
		enabled: true,
		uniqueId: "MyUniqueID",
		delay: 1000,
	},
	blockStyles: {
		bold: "__",
		italic: "_"
	},
	element: document.getElementById("mdSection"),
	forceSync: true,
	hideIcons: ["guide", "heading"],
	indentWithTabs: false,
	initialValue: "Hello world!",
	insertTexts: {
		horizontalRule: ["", "\n\n-----\n\n"],
		image: ["![](http://", ")"],
		link: ["[", "](http://)"],
		table: ["", "\n\n| Column 1 | Column 2 | Column 3 |\n| -------- | -------- | -------- |\n| Text     | Text      | Text     |\n\n"],
	},
	lineWrapping: true,
	parsingConfig: {
		allowAtxHeaderWithoutSpace: true,
		strikethrough: false,
		underscoresBreakWords: true,
	},
	placeholder: "Type here...",
	previewRender: function(plainText) {
		return customMarkdownParser(plainText); // Returns HTML from a custom parser
	},
	previewRender: function(plainText, preview) { // Async method
		setTimeout(function(){
			preview.innerHTML = customMarkdownParser(plainText);
		}, 250);

		return "Loading...";
	},
	promptURLs: true,
	renderingConfig: {
		singleLineBreaks: false,
		codeSyntaxHighlighting: true,
	},
	shortcuts: {
		drawTable: "Cmd-Alt-T"
	},
	showIcons: ["code", "table"],
	spellChecker: false,
	status: false,
	status: ["autosave", "lines", "words", "cursor"], // Optional usage
	status: ["autosave", "lines", "words", "cursor", {
		className: "keystrokes",
		defaultValue: function(el) {
			this.keystrokes = 0;
			el.innerHTML = "0 Keystrokes";
		},
		onUpdate: function(el) {
			el.innerHTML = ++this.keystrokes + " Keystrokes";
		}
	}], // Another optional usage, with a custom status bar item that counts keystrokes
	styleSelectedText: false,
	tabSize: 4,
    toolbar: false,
    // toolbar: [
    //     {
    //         name: "redText",
    //         action: drawRedText,
    //         className: "fa fa-bold", // Look for a suitable icon
    //         title: "Red text (Ctrl/Cmd-Alt-R)",
    //     }
    // ],
	toolbarTips: false,
});


// function drawRedText(editor) {

//     var cm = editor.codemirror;
//     var output = '';
//     var selectedText = cm.getSelection();
//     var text = selectedText || 'placeholder';

//     output = '<span>!!' + text + '!!</span>';
//     cm.replaceSelection(output);

// }


// var simplemde = new SimpleMDE();
simplemde.value(URI);

simplemde.codemirror.on("change", function(){
    insertImage();
    console.log(simplemde);
});

function insertImage(){
    let urls = document.getElementsByClassName("cm-url");
    for (var i=0;i<urls.length;i++){
        if (urls[i].classList.contains('cm-formatting') == false){
            let imgElem = document.createElement("img");
            imgElem.src = urls[i].innerHTML;
            console.log(urls[i].parentElement);
            urls[i].parentElement.appendChild(imgElem);
            console.log(urls[i].parentElement);
        };
    }
}
window.scrollTo(0,0);
</script>
